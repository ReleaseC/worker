<div class="tasklist">

  <div class="filter">

    <div>
      <span>ç”¨æˆ·ï¼š</span>
      <select [(ngModel)]="selPhone" (change)="onUserSelected()">
        <option *ngFor="let user of userList" [selected]="user.user_id===selUserId">{{ user.phone }}</option>
      </select>
    </div>

    <div>
      <span>æ´»åŠ¨ï¼š</span>
      <select [(ngModel)]="selActivity" (change)="onActivitySelected()">
        <option *ngFor="let activity of activityList"  [selected]="activity.activity_id===selActivityId">{{activity.activity_name}}</option>
      </select>
    </div>

    <div class="filter_time">
      <a>æ—¶é—´ï¼š</a>
      <input type="date" [(ngModel)]="createdAt" (change)="getTaskList(true)" id="time">
    </div>

    <div class="filter_state">
      <a>ä»»åŠ¡çŠ¶æ€ï¼š</a>
      <select [(ngModel)]="state" (change)="getTaskList(true)">
        <option value="">å…¨éƒ¨</option>
        <option value="create">åˆ›å»º</option>
        <option value="data_ready">å‡†å¤‡</option>
        <option value="start">å¼€å§‹</option>
        <option value="progress">å‰ªè¾‘</option>
        <option value="complete">å®Œæˆ</option>
        <option value="abort">æŸå</option>
      </select>
    </div>

    <div>
      <a>æ¯é¡µæ˜¾ç¤ºæ¡æ•°ï¼š</a>
      <select [(ngModel)]="pageItems" (change)="getTaskList(true)">
        <option>50</option>
        <option>10</option>
        <option>20</option>
        <option>100</option>
      </select>
    </div>
    <div>
      <span>è§†é¢‘é‡:{{this.taskCount}}</span>
    </div>


  </div>
  <div class="show_table">
    <table border="1">
      <tr>
        <td (click)="sortByCreateTime()" style="cursor:pointer">
          <span>åˆ›å»ºæ—¶é—´</span><span>{{createTimeSort?"ğŸ”½":"ğŸ”¼"}}</span>
        </td>
        <td>
          <span>ç”¨æˆ·</span>
        </td>
        <td>
          <span>æ´»åŠ¨</span>
        </td>
        <td>ç±»å‹</td>
        <td>çŠ¶æ€</td>
        <td>äº§å‡º</td>
        <td>æ˜¯å¦è´­ä¹°</td>
        <td>åŸå§‹æ–‡ä»¶</td>
        <td>å¯åŠ¨ä»»åŠ¡</td>
        <td>æ“ä½œ</td>
      </tr>

      <tr *ngFor="let task of taskList;index as i">
        <td>{{task.createdAt}}</td>
        <td>{{task.phone || '----'}}</td>
        <td>{{task.activity_name || '----'}}</td>
        <td>{{replaceTaskMode(task.task.mode)}}</td>
        <td [ngStyle]="{'color':task.state == 'abort' ? 'red':''}">{{ replaceTaskState(task.state) }}</td>
        <!--<td>-->
          <!--<ul style="text-align: center;">-->
            <!--<li *ngFor="let device of task.task.detail" style="height:21px;overflow:hidden;">{{device.role=="VideoCam"?"vc":device.role}}{{device.position.length>2?"":device.position}}</li>-->
          <!--</ul>-->
        <!--</td>-->
        <!--<td>-->
          <!--<ul>-->
            <!--<li *ngFor="let device of task.task.detail" style="height:21px;overflow: hidden;"-->
                <!--title="{{device.msg?device.msg:'&nbsp;'}}">{{device.msg?device.msg:"&nbsp;"}}-->
            <!--</li>-->
          <!--</ul>-->
        <!--</td>-->

        <td>
          <a *ngIf="task.state === 'complete' && task.task.mode === 'photo' " href="{{task.activity_id=='1541382418'||task.activity_id=='1541732870qz'?'https://siiva-video-public.oss-cn-hangzhou.aliyuncs.com/soccer_'+task.task.taskId+'.jpg':'https://siiva-video-public.oss-cn-hangzhou.aliyuncs.com/'+task.activity_id+'/'+task.task.taskId+'.jpg'}}"
             target="_blank" style="display:block">æŸ¥çœ‹</a>
          <a *ngIf="task.state === 'complete' && task.task.mode !== 'photo' " href="{{task.activity_id=='1541382418'||task.activity_id=='1541732870qz'?'https://siiva-video-public.oss-cn-hangzhou.aliyuncs.com/soccer_'+task.task.taskId+'.mp4':'https://siiva-video-public.oss-cn-hangzhou.aliyuncs.com/'+task.activity_id+'/'+task.task.taskId+'.mp4'}} "
             target="_blank" style="display:block">æŸ¥çœ‹</a>
        </td>
        <td [ngStyle]="{'color':task.task.is_pay==1? '#3dcc6d':'#a4abb3'}">{{task.task.is_pay=='1'?'æ˜¯':'å¦'}}</td>
        <td style="max-width:100px; max-height: 50px;">
          <button (click)="checkVideo(task)">æµè§ˆ</button>
        </td>
        <td><button (click)="clickRun(task)" [disabled]="task.state === 'cancel'">å¯åŠ¨</button></td>
        <td style="position:relative;">
          <button (click)="delTask(task)">åˆ é™¤</button>
        <!--<span style="color: white; font-size: 10px; position:absolute; right:0px; top:0px;" [ngStyle]="{'background':replaceTasktriggerBy(task.task.triggerBy) == 'æ‰‹åŠ¨' ? 'palevioletred':'#43A047'}">{{replaceTasktriggerBy(task.task.triggerBy)}}</span>-->
        <span *ngIf="replaceTasktriggerBy(task.task.triggerBy) === 'æ‰‹åŠ¨'" style="background: palevioletred; color: white; font-size: 10px; position:absolute; right:0px; top:0px;">{{replaceTasktriggerBy(task.task.triggerBy)}}</span>
        <span *ngIf="replaceTasktriggerBy(task.task.triggerBy) === 'è‡ªåŠ¨'" style="background: #43A047; color: white; font-size: 10px; position:absolute; right:0px; top:0px;">{{replaceTasktriggerBy(task.task.triggerBy)}}</span>
        <span *ngIf="replaceTasktriggerBy(task.task.triggerBy) === 'æµ‹è¯•'" style="background: #0d10df; color: white; font-size: 10px; position:absolute; right:0px; top:0px;">{{replaceTasktriggerBy(task.task.triggerBy)}}</span>

        </td>

      </tr>
    </table>
    <div class="page_select">
      <button class="btn_page" (click)="pageUp()" [ngStyle]="{'color':this.pageIndex  === 1 ? '#A4ABB3':'#409eff'}">ä¸Šä¸€é¡µ</button>
      <input type="text" [(ngModel)]="pageIndex" style="width:1.5em; text-align: center">
      <button class="btn_page" (click)="pageDown()" [ngStyle]="{'color':this.pageIndex < pages  ? '#409eff':'#A4ABB3'}">ä¸‹ä¸€é¡µ</button>
      <span>å…±{{pages}}é¡µ</span>
    </div>
  </div>
</div>

